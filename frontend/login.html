<!DOCTYPE html>
<html>
<head><title>Login</title></head>
<body>
  <h2>Login</h2>
  <form id="loginForm">
    <input name="email" placeholder="Email" type="email" />
    <input name="password" placeholder="Pwd" type="password" />
    <button>Login</button>
  </form>
  <script type="module">
    import { apiFetch, setToken } from './auth.js';
    document.getElementById('loginForm').onsubmit = async e => {
      e.preventDefault();
      const form = e.target;
      try {
        const res = await apiFetch('/api/auth/login', {
          method: 'POST',
          body: JSON.stringify({ email: form.email.value, password: form.password.value })
        });
        setToken(res.token);
        alert('Logged in successfully!');
        location = 'listings.html';
      } catch (err) {
        alert(err.message);
      }
    };
  </script>
</body>
</html>
